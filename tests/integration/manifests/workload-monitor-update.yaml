---
# Test 10 - Update Workload Monitor Manifest
# This includes updated resources + additional resources

# Main workload namespace (same)
apiVersion: v1
kind: Namespace
metadata:
  name: env-staging-abc123
  labels:
    app.kubernetes.io/name: test-workload-cluster
    workload-type: main
    test-scenario: workload-monitor-e2e
    updated: "true"  # Added label to trigger update
---
# App workload namespace (same)
apiVersion: v1
kind: Namespace
metadata:
  name: env-staging-abc123-app
  labels:
    workload-type: app
    test-scenario: workload-monitor-e2e
    updated: "true"  # Added label to trigger update
---
# DB workload namespace (same)
apiVersion: v1
kind: Namespace
metadata:
  name: env-staging-abc123-db
  labels:
    workload-type: db
    test-scenario: workload-monitor-e2e
    updated: "true"  # Added label to trigger update
---
# Main workload pod (updated)
apiVersion: v1
kind: Pod
metadata:
  name: main-workload-pod
  namespace: env-staging-abc123
  labels:
    app: workload-test
    component: main
    workload-id: abc123
    updated: "true"  # Added label to trigger update
spec:
  containers:
  - name: main-worker
    image: nginx:1.21
    ports:
    - containerPort: 80
    env:
    - name: WORKLOAD_ID
      value: "abc123"
    - name: COMPONENT
      value: "main"
    - name: UPDATED
      value: "true"  # Added env var to trigger update
---
# Main workload configmap (updated)
apiVersion: v1
kind: ConfigMap
metadata:
  name: main-workload-config
  namespace: env-staging-abc123
  labels:
    app: workload-test
    component: main
    workload-id: abc123
    updated: "true"  # Added label to trigger update
data:
  workload.yaml: |
    workload:
      id: abc123
      name: test-workload-cluster
      namespace: env-staging-abc123
      type: main
      updated: true
  new-config: "additional-data"  # Added data to trigger update
---
# App workload pod (new resource)
apiVersion: v1
kind: Pod
metadata:
  name: app-workload-pod
  namespace: env-staging-abc123-app
  labels:
    app: workload-test
    component: app
    workload-id: abc123
spec:
  containers:
  - name: app-worker
    image: nginx:1.21
    ports:
    - containerPort: 80
    env:
    - name: WORKLOAD_ID
      value: "abc123"
    - name: COMPONENT
      value: "app"
---
# App workload configmap (new resource)
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-workload-config
  namespace: env-staging-abc123-app
  labels:
    app: workload-test
    component: app
    workload-id: abc123
data:
  workload.yaml: |
    workload:
      id: abc123
      name: test-workload-cluster
      namespace: env-staging-abc123-app
      type: app
---
# DB workload pod (new resource)
apiVersion: v1
kind: Pod
metadata:
  name: db-workload-pod
  namespace: env-staging-abc123-db
  labels:
    app: workload-test
    component: db
    workload-id: abc123
spec:
  containers:
  - name: db-worker
    image: nginx:1.21
    ports:
    - containerPort: 80
    env:
    - name: WORKLOAD_ID
      value: "abc123"
    - name: COMPONENT
      value: "db"
---
# DB workload configmap (new resource)
apiVersion: v1
kind: ConfigMap
metadata:
  name: db-workload-config
  namespace: env-staging-abc123-db
  labels:
    app: workload-test
    component: db
    workload-id: abc123
data:
  workload.yaml: |
    workload:
      id: abc123
      name: test-workload-cluster
      namespace: env-staging-abc123-db
      type: db